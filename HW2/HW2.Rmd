---
title: "HW2"
author: "Nick McManus and Katheryn Moya"
date: "2023-04-20"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(here)
library(tidyverse)
```

### Read in data
```{r}
clim_df <- read_table("clim.txt") %>% 
  ### remove quotes in names
  janitor::clean_names()

```

### Climate data 

First we'll create a data subset with the average precipitation and absolute minimum and maximum temperatures for each month. Then, we'll form two subsets for use in the almond yield function: one with minimum February temperature and another with average January precipitation.
```{r}
### Find the absolute tmin and tmax
### as well as average precip for each month in dataset
clim_avg <- clim_df %>% 
  group_by(month, year) %>% 
  summarize(tmax_abs = max(tmax_c),
            tmin_abs = min(tmin_c),
            precip_avg = mean(precip))


### Min temps from Feb
feb_tmin <- clim_avg %>% 
  filter(month == 2) %>% 
  select(year, tmin_abs)
  

### Avg precip from Jan
jan_precip <- clim_avg %>% 
  filter(month == 1) %>% 
  select(year, precip_avg)
```





### Almond test fxn
```{r}

test <- function(min_temp, precip) {
  yield = -0.015*(min_temp) - 0.0046*(min_temp^2) - 0.07*(precip) + 0.0043*(precip^2) + 0.28
  
  return(yield)
}
```












